# generated by `./generate_action_config.py indigo`
# jsk_travis
on: [push, pull_request]

jobs:
  hydro:
    runs-on: ubuntu-latest
    name: hydro

    container: ubuntu:12.04

    steps:
      - name: Chcekout
        uses: actions/checkout@v1
      - name: Skip after_script for some readon... # after_script fails on catkin_test_results
        run: |
          sed -i 's/archive.ubuntu.com/old-releases.ubuntu.com/g' /etc/apt/sources.list
          apt-get update && apt-get install -y git
          git submodule update --init .travis
          sed -i -e '/#\ after_script/,+6 s/^/#/' .travis/travis.sh
          cat .travis/travis.sh
      - name: Run jsk_travis
        uses: jsk-ros-pkg/jsk_travis@master
        with:
          ROS_DISTRO : hydro
          ROS_PARALLEL_TEST_JOBS: "-j8"
          # do not generate roseus message that fails ERROR:  Cannot locate message [FootstepArray] in package [jsk_footstep_msgs] with path
          BEFORE_SCRIPT: "\\${CI_SOURCE_PATH}/.travis_before_script_jsk_recognition_utils.bash; sed -i 's@roseus@@' \\${CI_SOURCE_PATH}/jsk_footstep_planner/CMakeLists.txt;"
          ROS_REPOSITORY_PATH: "http://snapshots.ros.org/hydro/final/ubuntu"
          NOT_TEST_INSTALL: true
          CATKIN_TOOLS_BUILD_OPTIONS: "-iv --summarize --no-status"
